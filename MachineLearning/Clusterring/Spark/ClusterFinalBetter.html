<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>ClusterFinalBetter - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta name="robots" content="nofollow">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableSshKeyUI":false,"defaultInteractivePricePerDBU":0.4,"enableOnDemandClusterType":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","enableJobsPrefetching":true,"workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/index.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableClearStateFeature":false,"dbcForumURL":"http://forums.databricks.com/","enableProtoClusterInfoDeltaPublisher":true,"maxCustomTags":45,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"support_ssh":false,"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"node_instance_type":{"instance_type_id":"r3.2xlarge","provider":"AWS","compute_units":26.0,"number_of_ips":15,"local_disks":1,"reserved_compute_units":3.64,"memory_mb":62464,"num_cores":8,"reserved_memory_mb":4800},"memory_mb":6144,"is_hidden":false,"category":"Community Edition","num_cores":0.88,"support_ebs_volumes":false,"is_deprecated":false}],"default_node_type_id":"dev-tier-node"},"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"enableTableHandler":true,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableCustomSpotPricingUIByTier":false,"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":true,"clusters":true,"allowRunOnPendingClusters":true,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":false,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"enableNotebookCommandNumbers":true,"sparkVersions":[{"key":"1.6.3-db2-hadoop2-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-aba860a0ffce4f3471fb14aefdcb1d768ac66a53a5ad884c48745ef98aeb9d67","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.11","displayName":"Spark 2.2 RC2 (Experimental, Scala 2.11)","packageLabel":"spark-image-56c2cdbb969d51a3f238b9ebee9e2029cfb61f8fa282b9941fd86da4268ddf18","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.11","displayName":"Spark 2.1.0-db2 (Scala 2.11)","packageLabel":"spark-image-267c4490a3ab8a39acdbbd9f1d36f6decdecebf013e30dd677faff50f1d9cf8b","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.10","displayName":"Spark 2.0.2-db3 (Scala 2.10)","packageLabel":"spark-image-584091dedb690de20e8cf22d9e02fdcce1281edda99eedb441a418d50e28088f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0-db1 (Scala 2.11)","packageLabel":"spark-image-e8ad5b72cf0f899dcf2b4720c1f572ab0e87a311d6113b943b4e1d4a7edb77eb","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.1-db4-scala2.11","displayName":"Spark 2.1.1-db4 (Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db2-scala2.10","displayName":"Spark 2.1.0-db2 (Scala 2.10)","packageLabel":"spark-image-a2ca4f6b58c95f78dca91b1340305ab3fe32673bd894da2fa8e1dc8a9f8d0478","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.2-db4-scala2.11","displayName":"Spark 2.0.2-db4 (Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-968b89f1d0ec32e1ee4dacd04838cae25ef44370a441224177a37980d539d83a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db2-hadoop1-scala2.10","displayName":"Spark 1.6.3-db2 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-14112ea0645bea94333a571a150819ce85573cf5541167d905b7e6588645cf3b","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.1-db4-scala2.10","displayName":"Spark 2.1.1-db4 (Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db4-scala2.10","displayName":"Spark 2.0.2-db4 (Scala 2.10)","packageLabel":"spark-image-859e88079f97f58d50e25163b39a1943d1eeac0b6939c5a65faba986477e311a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.2.x-scala2.10","displayName":"Spark 2.2 RC2 (Experimental, Scala 2.10)","packageLabel":"spark-image-3aa5d0a0bd86bb8f06ec7e40ccd7dd5892a04da6d27ba6ac426cddea97c61757","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-7dbc7583e8271765b8a1508cb9e832768e35489bbde2c4c790bc6766aee2fd7f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db3-scala2.10","displayName":"Spark 2.1.0-db3 (Scala 2.10)","packageLabel":"spark-image-25a17d070af155f10c4232dcc6248e36a2eb48c24f8d4fc00f34041b86bd1626","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.2-db3-scala2.11","displayName":"Spark 2.0.2-db3 (Scala 2.11)","packageLabel":"spark-image-7fd7aaa89d55692e429115ae7eac3b1a1dc4de705d50510995f34306b39c2397","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.x-scala2.11","displayName":"Spark 2.1 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-52bca0ca866e3f4243d3820a783abf3b9b3b553edf234abef14b892657ceaca9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0-db1 (Scala 2.10)","packageLabel":"spark-image-f0ab82a5deb7908e0d159e9af066ba05fb56e1edb35bdad41b7ad2fd62a9b546","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":true,"customerVisible":false},{"key":"2.1.0-db3-scala2.11","displayName":"Spark 2.1.0-db3 (Scala 2.11)","packageLabel":"spark-image-ccbc6b73f158e2001fc1fb8c827bfdde425d8bd6d65cb7b3269784c28bb72c16","upgradable":true,"deprecated":false,"customerVisible":true}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":true,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"autoTerminateClustersByDefault":false,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"class-node":1,"m4.2xlarge":0.5,"r4.xlarge":1,"m4.4xlarge":0.5,"r4.16xlarge":8,"p2.8xlarge":16,"m4.10xlarge":0.5,"r3.8xlarge":8,"r4.4xlarge":4,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"m4.xlarge":0.5,"r4.8xlarge":8,"r4.large":0.5,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"memory-optimized":1,"m4.large":0.5,"p2.16xlarge":24,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"m4.16xlarge":0.5,"c4.8xlarge":4,"r3.xlarge":1,"r4.2xlarge":2,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":true,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.44","accountsLimit":3,"enableSparkEnvironmentVariables":true,"enableX509Authentication":false,"enableStructuredStreamingNbOptimizations":false,"enableNotebookGitBranching":true,"local":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"enableNotebookCommandMode":true,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"perClusterAutoTerminationEnabled":false,"enableCssTransitions":true,"defaultAutoTerminationInactivityMin":180,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableSshKeyUIByTier":false,"defaultAutomatedPricePerDBU":0.2,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":2047,"enableNewClustersList":false,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"enableSparkEnvironmentVariablesUI":false,"defaultSparkVersion":{"key":"2.1.x-scala2.10","displayName":"Spark 2.1 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-c7c0224de396cd1563addc1ae4bca6ba823780b6babe6c3729ddf73008f29ba4","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":false,"enableMountAclsConfig":false,"useDevTierHomePage":true,"enableClusterClone":true,"enableNotebookLineNumbers":true,"enablePublishHub":false,"minAutoTerminationInactivityMin":10,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","cloud":"AWS","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","mavenCentralSearchEndpoint":"http://search.maven.org/solrsearch/select","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"676f2940f1dab399891b5d5dde6fd279c2c076c0","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableNewTableUI":true,"enableDebugUI":false,"enableStreamingMetricsDashboard":true,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"useStandardTierUpgradeTooltips":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSpotClusterType":true,"enableSparkPackages":true,"dynamicSparkVersions":true,"enableClusterTagsUIByTier":false,"enableNotebookHistoryUI":true,"enableClusterLoggingUI":true,"maxAutoTerminationInactivityMin":10000,"enableDatabaseDropdownInTableUI":false,"showDebugCounters":false,"enableInstanceProfilesUI":false,"enableFolderHtmlExport":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"enableClusterStart":false,"enableEBSVolumesUIByTier":false,"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"accounts":true,"useOnDemandClustersByDefault":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"showTerminationReason":true,"enableNewClustersGet":true,"showPricePerDBU":false,"showSqlProxyUI":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":2954834256273161,"name":"ClusterFinalBetter","language":"python","commands":[{"version":"CommandV1","origId":2954834256273163,"guid":"17096991-8338-4226-a4fe-35f6cd113ae1","subtype":"command","commandType":"auto","position":0.0,"command":"%md ## Clustering\nIn this exercise, you will use K-Means clustering to segment customer data into five clusters.\n\n### Import the Libraries\nYou will use the **KMeans** class to create your model. This will require a vector of features, so you will also use the **VectorAssembler** class.\n","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1494355008459,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"nuid":"9ffb306b-776e-44ac-be4b-80f50bf8ac48"},{"version":"CommandV1","origId":2954834256273164,"guid":"cb4810f7-3ca1-48b0-9d70-a6c708d9a448","subtype":"command","commandType":"auto","position":1.0,"command":"from pyspark.sql.types import *\nfrom pyspark.sql.functions import *\n\nfrom pyspark.ml.clustering import KMeans\nfrom pyspark.ml.feature import StringIndexer\nfrom pyspark.ml.feature import VectorAssembler","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1494355008628,"submitTime":1494355008477,"finishTime":1494355008668,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":false,"scrolled":false},"streamStates":{},"nuid":"c7fcd77f-f24d-4f57-a592-7fbc686f558d"},{"version":"CommandV1","origId":2954834256273165,"guid":"3a30c0b7-ce73-43fc-9400-1a3d11f3e5b9","subtype":"command","commandType":"auto","position":2.0,"command":"%md ### Load Source Data\nThe source data for your clusters is in a comma-separated values (CSV) file, and incldues the following features:\n- CustomerName: The custome's name\n- Age: The customer's age in years\n- MaritalStatus: The custtomer's marital status (1=Married, 0 = Unmarried)\n- IncomeRange: The top-level for the customer's income range (for example, a value of 25,000 means the customer earns up to 25,000)\n- Gender: A numeric value indicating gender (1 = female, 2 = male)\n- TotalChildren: The total number of children the customer has\n- ChildrenAtHome: The number of children the customer has living at home.\n- Education: A numeric value indicating the highest level of education the customer has attained (1=Started High School to 5=Post-Graduate Degree\n- Occupation: A numeric value indicating the type of occupation of the customer (0=Unskilled manual work to 5=Professional)\n- HomeOwner: A numeric code to indicate home-ownership (1 - home owner, 0 = not a home owner)\n- Cars: The number of cars owned by the customer.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1494355008482,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"nuid":"b21a30ed-d7a0-4a85-9c5f-607d732cae37"},{"version":"CommandV1","origId":2954834256273166,"guid":"93c49e2d-576f-49cf-8214-6075d5e0d2df","subtype":"command","commandType":"auto","position":5.0,"command":"# Adopt shcmea to read csv data set in the schema. \n\n'''customers= spark.read.csv('swift://Unsupervised13.' + name + '/customers.csv', header=\"true\", inferSchema=\"true\",mode=\"DROPMALFORMED\")'''\ncsv = sqlContext.sql(\"Select * from food2\")\n\n","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1494355008673,"submitTime":1494355008503,"finishTime":1494355008747,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":true},"streamStates":{},"nuid":"171263d4-789c-4e0a-be54-abfedea1a4bf"},{"version":"CommandV1","origId":2954834256273167,"guid":"c3a66db3-d3a7-4b2a-85d0-2fb99d1c999a","subtype":"command","commandType":"auto","position":5.5,"command":"data = csv.select(\"review_count\",\"Take-out\", \"GoodFor_lunch\", \"GoodFor_dinner\", \"GoodFor_breakfast\",\"stars\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1494355008757,"submitTime":1494355008508,"finishTime":1494355008828,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fadee2d6-031e-4981-89bf-353bd07b4266"},{"version":"CommandV1","origId":2954834256273168,"guid":"8b57f673-637e-443e-8d67-cdb9440a59bd","subtype":"command","commandType":"auto","position":6.0,"command":"data.show(5)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+------------+--------+-------------+--------------+-----------------+-----+\n|review_count|Take-out|GoodFor_lunch|GoodFor_dinner|GoodFor_breakfast|stars|\n+------------+--------+-------------+--------------+-----------------+-----+\n|           4|    TRUE|        FALSE|         FALSE|            FALSE|    1|\n|          20|    TRUE|         TRUE|         FALSE|            FALSE|    1|\n|          21|    TRUE|        FALSE|          TRUE|            FALSE|    1|\n|           8|    TRUE|        FALSE|         FALSE|            FALSE|    1|\n|           4|     N/A|          N/A|           N/A|              N/A|    1|\n+------------+--------+-------------+--------------+-----------------+-----+\nonly showing top 5 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1494355008834,"submitTime":1494355008513,"finishTime":1494355009257,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":false,"scrolled":false},"streamStates":{},"nuid":"cc50e02c-cee6-41a2-a377-53d123fdb156"},{"version":"CommandV1","origId":961346316434552,"guid":"2c2c3fa0-a46e-402b-b510-88deb7b89773","subtype":"command","commandType":"auto","position":6.25,"command":"%md ### String Indexer\n\nStringIndexer encodes a string column of labels to a column of label indices. ","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"65817365-4296-4902-91ed-912f256cf158"},{"version":"CommandV1","origId":2954834256273169,"guid":"cd2142a1-801a-4739-b13b-c7bb9618ed3e","subtype":"command","commandType":"auto","position":6.5,"command":"def indexStringColumns(df, cols):\n    #variable newdf will be updated several times\n    newdata = df\n    for c in cols:\n        si = StringIndexer(inputCol=c, outputCol=c+\"-x\")\n        sm = si.fit(newdata)\n        newdata = sm.transform(newdata).drop(c)\n        newdata = newdata.withColumnRenamed(c+\"-x\", c)\n    return newdata\n\ndfnumeric = indexStringColumns(data, [\"Take-out\",\"GoodFor_lunch\", \"GoodFor_dinner\", \"GoodFor_breakfast\"])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: global name &apos;StringIndexer&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-6-3bf27d0c2309&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      9</span>     <span class=\"ansigreen\">return</span> newdata<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     10</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 11</span><span class=\"ansiyellow\"> </span>dfnumeric <span class=\"ansiyellow\">=</span> indexStringColumns<span class=\"ansiyellow\">(</span>data<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&quot;Take-out&quot;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&quot;GoodFor_lunch&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;GoodFor_dinner&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;GoodFor_breakfast&quot;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&quot;Noise_Level&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;Takes_Reservations&quot;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&quot;Delivery&quot;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&quot;Parking_lot&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;WheelchairAccessible&quot;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&quot;Alcohol&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;WaiterService&quot;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&quot;Wi-Fi&quot;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">&lt;ipython-input-6-3bf27d0c2309&gt;</span> in <span class=\"ansicyan\">indexStringColumns</span><span class=\"ansiblue\">(df, cols)</span>\n<span class=\"ansigreen\">      3</span>     newdata <span class=\"ansiyellow\">=</span> df<span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span>     <span class=\"ansigreen\">for</span> c <span class=\"ansigreen\">in</span> cols<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 5</span><span class=\"ansiyellow\">         </span>si <span class=\"ansiyellow\">=</span> StringIndexer<span class=\"ansiyellow\">(</span>inputCol<span class=\"ansiyellow\">=</span>c<span class=\"ansiyellow\">,</span> outputCol<span class=\"ansiyellow\">=</span>c<span class=\"ansiyellow\">+</span><span class=\"ansiblue\">&quot;-x&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      6</span>         sm <span class=\"ansiyellow\">=</span> si<span class=\"ansiyellow\">.</span>fit<span class=\"ansiyellow\">(</span>newdata<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      7</span>         newdata <span class=\"ansiyellow\">=</span> sm<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>newdata<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>drop<span class=\"ansiyellow\">(</span>c<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: global name &apos;StringIndexer&apos; is not defined</div>","workflows":[],"startTime":1494355009262,"submitTime":1494355008518,"finishTime":1494355010974,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4cc946d7-765e-4a38-ae48-40f84439e35e"},{"version":"CommandV1","origId":961346316434553,"guid":"c8bfff30-acd7-406b-b612-3cd36018bb68","subtype":"command","commandType":"auto","position":6.625,"command":"%md ### Hot Encoder\n\nOne-hot encoding maps a column of label indices to a column of binary vectors, with at most a single one-value. ","commandVersion":0,"state":"error","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ceae4f3d-66c3-4668-b3f8-3e7e5c3bc37e"},{"version":"CommandV1","origId":2954834256273170,"guid":"9cfb1d2d-4b05-46d3-995a-5c4aa5b61cde","subtype":"command","commandType":"auto","position":6.75,"command":"def oneHotEncodeColumns(df, cols):\n    from pyspark.ml.feature import OneHotEncoder\n    newdf = df\n    for c in cols:\n        onehotenc = OneHotEncoder(inputCol=c, outputCol=c+\"-onehot\", dropLast=False)\n        newdf = onehotenc.transform(newdf).drop(c)\n        newdf = newdf.withColumnRenamed(c+\"-onehot\", c)\n    return newdf\n\ndfhot = oneHotEncodeColumns(dfnumeric, [\"Take-out\",\"GoodFor_lunch\", \"GoodFor_dinner\", \"GoodFor_breakfast\"])","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1494355010978,"submitTime":1494355008523,"finishTime":1494355011099,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"cdda9de8-288c-4495-9d4d-12196f554c3e"},{"version":"CommandV1","origId":2954834256273171,"guid":"000c317a-ca19-4503-b270-0778fd5bb049","subtype":"command","commandType":"auto","position":7.0,"command":"%md ### Create the K-Means Model\nYou will use the feaures in the customer data to create a Kn-Means model with a k value of 5. This will be used to generate 5 clusters.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1494355008527,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"nuid":"83a52807-61c7-434c-a8d9-fcb407bf00a4"},{"version":"CommandV1","origId":2954834256273172,"guid":"c33e3576-3934-46f9-aa6f-1f09f059d058","subtype":"command","commandType":"auto","position":8.0,"command":"assembler = VectorAssembler(inputCols = list(set(dfhot.columns) | set(['stars','review_count'])), outputCol=\"features\")\ntrain = assembler.transform(dfhot)\n\nknum = 5\nkmeans = KMeans(featuresCol=assembler.getOutputCol(), predictionCol=\"cluster\", k=knum, seed=0)\nmodel = kmeans.fit(train)\nprint \"Model Created!\"","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Model Created!\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">IllegalArgumentException</span>: u&apos;Data type StringType is not supported.&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">IllegalArgumentException</span>                  Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-14-5ba8819b0fb0&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> assembler <span class=\"ansiyellow\">=</span> VectorAssembler<span class=\"ansiyellow\">(</span>inputCols <span class=\"ansiyellow\">=</span> list<span class=\"ansiyellow\">(</span>set<span class=\"ansiyellow\">(</span>dfhot<span class=\"ansiyellow\">.</span>columns<span class=\"ansiyellow\">)</span> <span class=\"ansiyellow\">|</span> set<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">[</span><span class=\"ansiblue\">&apos;stars&apos;</span><span class=\"ansiyellow\">,</span><span class=\"ansiblue\">&apos;review_count&apos;</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> outputCol<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;features&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>train <span class=\"ansiyellow\">=</span> assembler<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>data<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      4</span> knum <span class=\"ansiyellow\">=</span> <span class=\"ansicyan\">3</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> kmeans <span class=\"ansiyellow\">=</span> KMeans<span class=\"ansiyellow\">(</span>featuresCol<span class=\"ansiyellow\">=</span>assembler<span class=\"ansiyellow\">.</span>getOutputCol<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> predictionCol<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&quot;cluster&quot;</span><span class=\"ansiyellow\">,</span> k<span class=\"ansiyellow\">=</span>knum<span class=\"ansiyellow\">,</span> seed<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">0</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/base.pyc</span> in <span class=\"ansicyan\">transform</span><span class=\"ansiblue\">(self, dataset, params)</span>\n<span class=\"ansigreen\">    103</span>                 <span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>copy<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>_transform<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    104</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 105</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">return</span> self<span class=\"ansiyellow\">.</span>_transform<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    106</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    107</span>             <span class=\"ansigreen\">raise</span> ValueError<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&quot;Params must be a param map but got %s.&quot;</span> <span class=\"ansiyellow\">%</span> type<span class=\"ansiyellow\">(</span>params<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/ml/wrapper.pyc</span> in <span class=\"ansicyan\">_transform</span><span class=\"ansiblue\">(self, dataset)</span>\n<span class=\"ansigreen\">    250</span>     <span class=\"ansigreen\">def</span> _transform<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> dataset<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    251</span>         self<span class=\"ansiyellow\">.</span>_transfer_params_to_java<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 252</span><span class=\"ansiyellow\">         </span><span class=\"ansigreen\">return</span> DataFrame<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_java_obj<span class=\"ansiyellow\">.</span>transform<span class=\"ansiyellow\">(</span>dataset<span class=\"ansiyellow\">.</span>_jdf<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> dataset<span class=\"ansiyellow\">.</span>sql_ctx<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    253</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    254</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     77</span>                 <span class=\"ansigreen\">raise</span> QueryExecutionException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     78</span>             <span class=\"ansigreen\">if</span> s<span class=\"ansiyellow\">.</span>startswith<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;java.lang.IllegalArgumentException: &apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 79</span><span class=\"ansiyellow\">                 </span><span class=\"ansigreen\">raise</span> IllegalArgumentException<span class=\"ansiyellow\">(</span>s<span class=\"ansiyellow\">.</span>split<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;: &apos;</span><span class=\"ansiyellow\">,</span> <span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">[</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\">,</span> stackTrace<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     80</span>             <span class=\"ansigreen\">raise</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     81</span>     <span class=\"ansigreen\">return</span> deco<span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">IllegalArgumentException</span>: u&apos;Data type StringType is not supported.&apos;</div>","workflows":[],"startTime":1494355011103,"submitTime":1494355008555,"finishTime":1494355024190,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":false,"scrolled":false},"streamStates":{},"nuid":"f4823c91-de46-4992-881c-f812e371c175"},{"version":"CommandV1","origId":2954834256273173,"guid":"9f030c9c-20a6-4027-af05-7f152087ebdf","subtype":"command","commandType":"auto","position":9.0,"command":"%md ### Get the Cluster Centers\nThe cluster centers are indicated as vector coordinates.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1494355008561,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"nuid":"b11973e8-4927-4e24-8abd-cbca45e6bb6d"},{"version":"CommandV1","origId":2954834256273174,"guid":"cf82f9df-9b28-4e87-baaa-729dbed5136f","subtype":"command","commandType":"auto","position":10.0,"command":"centers = model.clusterCenters()\nprint(\"Cluster Centers: \")\nfor center in centers:\n    print(center)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Cluster Centers: \n[  6.59952607e-01   4.62085308e-02   2.93838863e-01   8.22274882e-01\n   4.50236967e-02   1.32701422e-01   3.97132701e+02   9.77488152e-01\n   4.59715640e-01   4.62085308e-02   4.94075829e-01   8.45971564e-01\n   4.62085308e-02   1.07819905e-01]\n[  0.4138402    0.38834509   0.19781471   0.60459822   0.33435769\n   0.06104409  19.1422718    0.82267243   0.49355035   0.38834509\n   0.11810456   0.56286516   0.38804158   0.04909325]\n[  7.64705882e-01   0.00000000e+00   2.35294118e-01   5.88235294e-01\n   0.00000000e+00   4.11764706e-01   3.24770588e+03   1.00000000e+00\n   5.88235294e-01   0.00000000e+00   4.11764706e-01   8.82352941e-01\n   0.00000000e+00   1.17647059e-01]\n[  4.85927771e-01   9.73848070e-02   4.16687422e-01   8.39352428e-01\n   9.56413450e-02   6.50062267e-02   1.38218182e+02   9.61145704e-01\n   5.27272727e-01   9.73848070e-02   3.75342466e-01   8.25404732e-01\n   9.73848070e-02   7.72104608e-02]\n[  7.38562092e-01   6.53594771e-03   2.54901961e-01   7.64705882e-01\n   6.53594771e-03   2.28758170e-01   1.01273856e+03   9.93464052e-01\n   4.18300654e-01   6.53594771e-03   5.75163399e-01   8.95424837e-01\n   6.53594771e-03   9.80392157e-02]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1494355024195,"submitTime":1494355008572,"finishTime":1494355024267,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":false,"scrolled":true},"streamStates":{},"nuid":"72c719d5-16fc-4ce7-8c3f-baf66c4ceea0"},{"version":"CommandV1","origId":2954834256273175,"guid":"94a47d1a-88d3-45b8-9147-2592942b2ed5","subtype":"command","commandType":"auto","position":11.0,"command":"%md ### Predict Clusters\nNow that you have trained the model, you can use it to segemnt the customer data into 5 clusters and show each customer with their allocated cluster.","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":1494355008576,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{},"streamStates":{},"nuid":"45712b7d-0de6-4742-b52f-2c2ab706ff44"},{"version":"CommandV1","origId":2954834256273176,"guid":"1e2b307f-a1c0-4518-931e-5da75d9cf99c","subtype":"command","commandType":"auto","position":12.0,"command":"# data set does not need to be divided to train and test\nprediction = model.transform(train)\nprediction.groupBy(\"cluster\").count().orderBy(\"cluster\").show()","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-------+-----+\n|cluster|count|\n+-------+-----+\n|      0|  822|\n|      1|26432|\n|      2|   16|\n|      3| 3964|\n|      4|  153|\n+-------+-----+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1494355024271,"submitTime":1494355008587,"finishTime":1494355025580,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":false,"scrolled":false},"streamStates":{},"nuid":"925a7062-1f15-4e10-b521-71ab6377af74"},{"version":"CommandV1","origId":2954834256273177,"guid":"22131ac2-22d7-4f12-bf59-a06669e04f76","subtype":"command","commandType":"auto","position":14.0,"command":"# Look at the features of each cluster\n\n# define dictionary\ncustomerCluster = {}\nfor i in range(0,knum):\n    tmp = prediction.select(\"stars\",\"review_count\",\"Take-out\",\"GoodFor_lunch\", \"GoodFor_dinner\", \"GoodFor_breakfast\")\\\n                                    .where(\"cluster =\" +  str(i))\n    customerCluster[str(i)]= tmp\n    print \"Cluster\"+str(i)\n    customerCluster[str(i)].show(50)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Cluster0\n+-----+------------+-------------+-------------+--------------+-----------------+\n|stars|review_count|     Take-out|GoodFor_lunch|GoodFor_dinner|GoodFor_breakfast|\n+-----+------------+-------------+-------------+--------------+-----------------+\n|    1|         420|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         277|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         268|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         582|(3,[0],[1.0])|(3,[2],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         277|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         375|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[2],[1.0])|\n|    1|         432|(3,[0],[1.0])|(3,[2],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         275|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         409|(3,[0],[1.0])|(3,[2],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         287|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         292|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         320|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         346|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         683|(3,[0],[1.0])|(3,[2],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         352|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         278|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         479|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         425|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         651|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         351|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         277|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         282|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         442|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         270|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         277|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         498|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         486|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         321|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[2],[1.0])|\n|    1|         275|(3,[0],[1.0])|(3,[2],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         296|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         286|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         279|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[2],[1.0])|\n|    1|         303|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[2],[1.0])|\n|    1|         304|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         341|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         393|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         302|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         436|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         317|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         457|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         371|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[2],[1.0])|\n|    1|         320|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         314|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         328|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[2],[1.0])|\n|    1|         650|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         387|(3,[1],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    1|         701|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         474|(3,[2],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    0|         374|(3,[0],[1.0])|(3,[2],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         393|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n+-----+------------+-------------+-------------+--------------+-----------------+\nonly showing top 50 rows\n\nCluster1\n+-----+------------+-------------+-------------+--------------+-----------------+\n|stars|review_count|     Take-out|GoodFor_lunch|GoodFor_dinner|GoodFor_breakfast|\n+-----+------------+-------------+-------------+--------------+-----------------+\n|    1|           4|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|          20|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|          21|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|           8|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|           4|(3,[1],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    1|           7|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|          58|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[2],[1.0])|\n|    1|           6|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|           7|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|           5|(3,[0],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    0|           9|(3,[0],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    1|           9|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|          64|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    0|           3|(3,[0],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    1|           3|(3,[0],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    1|          20|(3,[1],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    0|           3|(3,[1],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    0|          48|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|          30|(3,[2],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|          26|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    0|           5|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    0|           4|(3,[1],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    1|          31|(3,[1],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    0|          74|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|           5|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    0|          19|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|          41|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          22|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|           8|(3,[0],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    1|          43|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|           3|(3,[1],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    0|           3|(3,[1],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    0|           3|(3,[2],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    1|           3|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|           4|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|           4|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|          11|(3,[1],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    1|           4|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|          17|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|          12|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|           6|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|           3|(3,[1],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    1|           7|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|          14|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          17|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    0|           6|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|           9|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    0|           4|(3,[0],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    1|           4|(3,[2],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|          21|(3,[1],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n+-----+------------+-------------+-------------+--------------+-----------------+\nonly showing top 50 rows\n\nCluster2\n+-----+------------+-------------+-------------+--------------+-----------------+\n|stars|review_count|     Take-out|GoodFor_lunch|GoodFor_dinner|GoodFor_breakfast|\n+-----+------------+-------------+-------------+--------------+-----------------+\n|    1|        2818|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        2166|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|        2442|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        5642|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        3014|(3,[2],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|        3281|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        2714|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[2],[1.0])|\n|    1|        4452|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|        3478|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|        3014|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[2],[1.0])|\n|    1|        2404|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        4558|(3,[2],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|        2758|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|        2139|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        4390|(3,[2],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|        3811|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n+-----+------------+-------------+-------------+--------------+-----------------+\n\nCluster3\n+-----+------------+-------------+-------------+--------------+-----------------+\n|stars|review_count|     Take-out|GoodFor_lunch|GoodFor_dinner|GoodFor_breakfast|\n+-----+------------+-------------+-------------+--------------+-----------------+\n|    1|         124|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          82|(3,[0],[1.0])|(3,[2],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          99|(3,[0],[1.0])|(3,[2],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         106|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[2],[1.0])|\n|    1|         106|(3,[1],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    1|         251|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         146|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[2],[1.0])|\n|    1|         101|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         140|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          83|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         127|(3,[0],[1.0])|(3,[2],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          87|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         237|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[2],[1.0])|\n|    1|         266|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          84|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          93|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         181|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          87|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    0|         171|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    0|          92|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          93|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          83|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         208|(3,[0],[1.0])|(3,[2],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         162|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         150|(3,[0],[1.0])|(3,[2],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         170|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         107|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          82|(3,[1],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    1|         207|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          91|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         235|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          86|(3,[0],[1.0])|(3,[2],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         125|(3,[1],[1.0])|(3,[1],[1.0])| (3,[1],[1.0])|    (3,[1],[1.0])|\n|    1|         181|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         204|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[2],[1.0])|\n|    1|         158|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         212|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         196|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          97|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         210|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         127|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          99|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         224|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         148|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          83|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         228|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          79|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         148|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         120|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|          90|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n+-----+------------+-------------+-------------+--------------+-----------------+\nonly showing top 50 rows\n\nCluster4\n+-----+------------+-------------+-------------+--------------+-----------------+\n|stars|review_count|     Take-out|GoodFor_lunch|GoodFor_dinner|GoodFor_breakfast|\n+-----+------------+-------------+-------------+--------------+-----------------+\n|    1|        1087|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         888|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|        1907|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|        1229|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|        1074|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         744|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|        1551|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         817|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         710|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        1352|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         850|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         728|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        1007|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        1070|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        1003|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|        1312|(3,[0],[1.0])|(3,[2],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         757|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        1613|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         824|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        1302|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[2],[1.0])|\n|    1|         718|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         829|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        1175|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        1820|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[2],[1.0])|\n|    1|        1716|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         767|(3,[0],[1.0])|(3,[2],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        1327|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        1007|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         755|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        1373|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        1011|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         762|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         719|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        1937|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[2],[1.0])|\n|    1|        1339|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        1104|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         982|(3,[0],[1.0])|(3,[2],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        1013|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[2],[1.0])|\n|    1|         854|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|        1386|(3,[2],[1.0])|(3,[2],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         870|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         729|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[2],[1.0])|\n|    1|        1631|(3,[2],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         716|(3,[0],[1.0])|(3,[2],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         725|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|         876|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         783|(3,[2],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n|    1|         739|(3,[0],[1.0])|(3,[2],[1.0])| (3,[0],[1.0])|    (3,[0],[1.0])|\n|    1|        1624|(3,[0],[1.0])|(3,[0],[1.0])| (3,[0],[1.0])|    (3,[2],[1.0])|\n|    1|        1224|(3,[0],[1.0])|(3,[0],[1.0])| (3,[2],[1.0])|    (3,[0],[1.0])|\n+-----+------------+-------------+-------------+--------------+-----------------+\nonly showing top 50 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1494355025585,"submitTime":1494355008592,"finishTime":1494355028001,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":{"collapsed":false,"scrolled":true},"streamStates":{},"nuid":"44b0b44a-f58c-4e78-a4ec-be2c76e3c021"}],"dashboards":[],"guid":"9746fd8b-54de-42a8-b012-9c2c2e701d11","globalVars":{},"iPythonMetadata":{"nbformat":4,"IPythonMetadata":{"kernelspec":{"display_name":"Python 2 with Spark 2.0","language":"python","name":"python2-spark20"},"language_info":{"mimetype":"text/x-python","name":"python","pygments_lexer":"ipython2","codemirror_mode":{"name":"ipython","version":2},"version":"2.7.11","nbconvert_exporter":"python","file_extension":".py"}}},"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
